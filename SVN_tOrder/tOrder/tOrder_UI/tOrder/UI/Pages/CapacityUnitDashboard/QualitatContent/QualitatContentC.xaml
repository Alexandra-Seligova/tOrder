<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="tOrder.UI.QualitatContentC"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:tOrder.UI"
    xmlns:common="using:tOrder.Common"
    xmlns:toolkit="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignWidth="1024"
    d:DesignHeight="768">

    <UserControl.Resources>
        <common:BindingProxy x:Key="LayoutConfigProxy"
         x:Name="LayoutConfigProxy"
         Data="{x:Bind LayoutConfig, Mode=OneWay}" />

        <x:Double x:Key="FooterButtonMinWidth">140</x:Double>
        <x:Double x:Key="FooterButtonHeight">38</x:Double>
        <x:Double x:Key="FooterButtonFontSize">16</x:Double>
        <CornerRadius x:Key="FooterButtonCornerRadius">4</CornerRadius>
        <Thickness x:Key="FooterButtonMarginThickness">6,0,6,0</Thickness>
        <x:Double x:Key="FooterButtonViewboxHeight">22</x:Double>

        <Style x:Key="DisabledButtonStyle" TargetType="Button">
            <Setter Property="Opacity" Value="0.4"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="ToolTipService.ToolTip" Value="Prozatím vypnuto"/>
        </Style>

        <common:DateFormatConverter x:Key="DateFormatConverter"/>
    </UserControl.Resources>

    <Grid Background="#F5F7FA" Padding="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Hlavička -->
            <RowDefinition Height="*"/>
            <!-- Obsah dat -->
            <RowDefinition Height="Auto"/>
            <!-- Footer -->
        </Grid.RowDefinitions>

        <!-- HLAVIČKA S FILTRY -->
        <!-- HLAVIČKA S FILTRY -->
        <Viewbox Grid.Row="0" x:Name="FilterHeaderViewbox" Stretch="Uniform" Height="Auto" VerticalAlignment="Top">
            <Grid x:Name="FilterHeaderContainer"
          Width="{Binding Source={StaticResource LayoutConfigProxy}, Path=Data.DesignWidth}"
          Background="#F6F6F6"
          Padding="0,8">

                <Grid HorizontalAlignment="Center" Width="800">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Button x:Name="ShowAllButton" Grid.Column="0"
                    Background="#2196F3"
                    Foreground="White"
                    FontWeight="Bold"
                    FontSize="{StaticResource FooterButtonFontSize}"
                    MinWidth="{StaticResource FooterButtonMinWidth}"
                    Height="{StaticResource FooterButtonHeight}"
                    Padding="0,6"
                    BorderThickness="0"
                    Margin="{StaticResource FooterButtonMarginThickness}"
                    CornerRadius="{StaticResource FooterButtonCornerRadius}"
                    Click="OnFilterClearClicked"
                    ToolTipService.ToolTip="Show all measurements">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8EF;" Margin="0,0,6,0"/>
                            <TextBlock Text="Alle zeigen"/>
                        </StackPanel>
                    </Button>

                    <ToggleButton x:Name="FilterGroup1" Grid.Column="1"
                          FontWeight="Bold"
                          Background="#2196F3"
                          Foreground="White"
                          FontSize="{StaticResource FooterButtonFontSize}"
                          MinWidth="{StaticResource FooterButtonMinWidth}"
                          Height="{StaticResource FooterButtonHeight}"
                          Padding="0,6"
                          BorderThickness="0"
                          Margin="{StaticResource FooterButtonMarginThickness}"
                          CornerRadius="{StaticResource FooterButtonCornerRadius}"
                          Click="OnFilterClicked"
                          ToolTipService.ToolTip="Show only SPC measurements">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71c;" Margin="0,0,6,0"/>
                            <TextBlock Text="SPC"/>
                        </StackPanel>
                    </ToggleButton>

                    <ToggleButton x:Name="FilterGroup2" Grid.Column="2"
                          FontWeight="Bold"
                          Background="#2196F3"
                          Foreground="White"
                          FontSize="{StaticResource FooterButtonFontSize}"
                          MinWidth="{StaticResource FooterButtonMinWidth}"
                          Height="{StaticResource FooterButtonHeight}"
                          Padding="0,6"
                          BorderThickness="0"
                          Margin="{StaticResource FooterButtonMarginThickness}"
                          CornerRadius="{StaticResource FooterButtonCornerRadius}"
                          Click="OnFilterClicked"
                          ToolTipService.ToolTip="Show only Unwert measurements">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71c;" Margin="0,0,6,0"/>
                            <TextBlock Text="Unwert"/>
                        </StackPanel>
                    </ToggleButton>

                    <ToggleButton x:Name="FilterGroup3" Grid.Column="3"
                          FontWeight="Bold"
                          Background="#2196F3"
                          Foreground="White"
                          FontSize="{StaticResource FooterButtonFontSize}"
                          MinWidth="{StaticResource FooterButtonMinWidth}"
                          Height="{StaticResource FooterButtonHeight}"
                          Padding="0,6"
                          BorderThickness="0"
                          Margin="{StaticResource FooterButtonMarginThickness}"
                          CornerRadius="{StaticResource FooterButtonCornerRadius}"
                          Click="OnFilterClicked"
                          ToolTipService.ToolTip="Show only Attributiv measurements">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71c;" Margin="0,0,6,0"/>
                            <TextBlock Text="Attributiv"/>
                        </StackPanel>
                    </ToggleButton>

                    <Button Grid.Column="4"
                    FontSize="20"
                    FontWeight="Bold"
                    Foreground="White"
                    Background="#D32F2F"
                    Padding="16,4"
                    BorderThickness="0"
                    CornerRadius="{StaticResource FooterButtonCornerRadius}"
                    VerticalAlignment="Center"
                    Margin="{StaticResource FooterButtonMarginThickness}"
                    Height="{StaticResource FooterButtonHeight}"
                    Click="OnFilterClearClicked"
                    ToolTipService.ToolTip="Clear filter">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="✖" VerticalAlignment="Center" Margin="0,0,0,0"/>
                        </StackPanel>
                    </Button>
                </Grid>
            </Grid>
        </Viewbox>


        <!-- TABELLE DER MESSPUNKTE -->
        <Viewbox Grid.Row="1" x:Name="QualitatDataGridViewbox" Stretch="Uniform" Height="Auto" VerticalAlignment="Top">
            <Grid x:Name="QualitatDataGridContainer"
                  Width="{Binding Source={StaticResource LayoutConfigProxy}, Path=Data.DesignWidth}"
                  Background="#F6F6F6">
                <toolkit:DataGrid x:Name="QualitatDataGrid"
                                  AutoGenerateColumns="False"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="All"
                                  IsReadOnly="True"
                                  RowHeight="32"
                                  SelectionMode="Single"
                                  BorderThickness="1"
                                  BorderBrush="#CCCCCC"
                                  ItemsSource="{x:Bind FilteredItems, Mode=OneWay}">
                    <toolkit:DataGrid.Columns>
                        <toolkit:DataGridTextColumn Header="Pos" Binding="{Binding Pos}" Width="Auto"/>
                        <toolkit:DataGridTextColumn Header="Merkmal" Binding="{Binding Merk}" Width="Auto"/>
                        <toolkit:DataGridTextColumn Header="Beschreibung" Binding="{Binding Beschreibung}" Width="2*"/>
                        <toolkit:DataGridTextColumn Header="Regelkarte" Binding="{Binding Regelkarte}" Width="Auto"/>
                        <toolkit:DataGridTextColumn Header="Zeitintervall (min)" Binding="{Binding ZeitintervallMin}" Width="Auto"/>
                        <toolkit:DataGridTextColumn Header="Stückintervall" Binding="{Binding Stueckintervall}" Width="Auto"/>

                        <toolkit:DataGridTemplateColumn Header="Letzte Messung (Datum)" Width="Auto">
                            <toolkit:DataGridTemplateColumn.CellTemplate>
                                <DataTemplate x:DataType="local:QualitatMessungItem">
                                    <TextBlock Text="{Binding LetzteMessungDatum, Converter={StaticResource DateFormatConverter}}" />
                                </DataTemplate>
                            </toolkit:DataGridTemplateColumn.CellTemplate>
                        </toolkit:DataGridTemplateColumn>

                        <toolkit:DataGridTextColumn Header="Letzte Messung (Zähler)" Binding="{Binding LetzteMessungZaehler}" Width="Auto"/>

                        <toolkit:DataGridTemplateColumn Header="Nächste Messung (Datum)" Width="Auto">
                            <toolkit:DataGridTemplateColumn.CellTemplate>
                                <DataTemplate x:DataType="local:QualitatMessungItem">
                                    <TextBlock Text="{Binding NaechsteMessungDatum, Converter={StaticResource DateFormatConverter}}" />
                                </DataTemplate>
                            </toolkit:DataGridTemplateColumn.CellTemplate>
                        </toolkit:DataGridTemplateColumn>

                        <toolkit:DataGridTextColumn Header="Nächste Messung (Zähler)" Binding="{Binding NaechsteMessungZaehler}" Width="Auto"/>
                    </toolkit:DataGrid.Columns>
                </toolkit:DataGrid>
            </Grid>
        </Viewbox>

        <!-- FOOTER TLAČÍTKA -->
        <Viewbox Grid.Row="2" x:Name="FooterViewbox" Stretch="Uniform" Height="Auto" VerticalAlignment="Top">
            <Grid x:Name="FooterWrapper" Padding="20,12" Background="#ECECEC" Width="{Binding Source={StaticResource LayoutConfigProxy}, Path=Data.DesignWidth}">


                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Messfilter -->
                <Button Grid.Column="0" Background="#888" Foreground="White" FontWeight="SemiBold"
                            FontSize="{StaticResource FooterButtonFontSize}"
                            MinWidth="{StaticResource FooterButtonMinWidth}"
                            Height="{StaticResource FooterButtonHeight}"
                            Padding="0,6" BorderThickness="0"
                            Margin="{StaticResource FooterButtonMarginThickness}"
                            CornerRadius="{StaticResource FooterButtonCornerRadius}"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Click="OnUnimplementedClicked"
                            ToolTipService.ToolTip="Filter measurements">
                    <Viewbox Height="{StaticResource FooterButtonViewboxHeight}" Stretch="Uniform">
                        <TextBlock Text="Messfilter" TextAlignment="Center"/>
                    </Viewbox>
                </Button>

                <!-- Aktualisieren -->
                <Button Grid.Column="1" Background="#2196F3" Foreground="White" FontWeight="SemiBold"
                            FontSize="{StaticResource FooterButtonFontSize}"
                            MinWidth="{StaticResource FooterButtonMinWidth}"
                            Height="{StaticResource FooterButtonHeight}"
                            Padding="0,6" BorderThickness="0"
                            Margin="{StaticResource FooterButtonMarginThickness}"
                            CornerRadius="{StaticResource FooterButtonCornerRadius}"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Click="OnUnimplementedClicked"
                            ToolTipService.ToolTip="Update data">
                    <Viewbox Height="{StaticResource FooterButtonViewboxHeight}" Stretch="Uniform">
                        <TextBlock Text="Aktualisieren" TextAlignment="Center"/>
                    </Viewbox>
                </Button>

                <!-- Neue Messung -->
                <Button Grid.Column="2" Background="#19599A" Foreground="White" FontWeight="Bold"
                            FontSize="{StaticResource FooterButtonFontSize}"
                            MinWidth="{StaticResource FooterButtonMinWidth}"
                            Height="{StaticResource FooterButtonHeight}"
                            Padding="0,6" BorderThickness="0"
                            Margin="{StaticResource FooterButtonMarginThickness}"
                            CornerRadius="{StaticResource FooterButtonCornerRadius}"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Click="OnUnimplementedClicked"
                            ToolTipService.ToolTip="Start new measurement">
                    <Viewbox Height="{StaticResource FooterButtonViewboxHeight}" Stretch="Uniform">
                        <TextBlock Text="Neue Messung" TextAlignment="Center"/>
                    </Viewbox>
                </Button>

                <!-- Messhistorie -->
                <Button Grid.Column="3" Background="#19599A" Foreground="White" FontWeight="Bold"
                            FontSize="{StaticResource FooterButtonFontSize}"
                            MinWidth="{StaticResource FooterButtonMinWidth}"
                            Height="{StaticResource FooterButtonHeight}"
                            Padding="0,6" BorderThickness="0"
                            Margin="{StaticResource FooterButtonMarginThickness}"
                            CornerRadius="{StaticResource FooterButtonCornerRadius}"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Click="OnUnimplementedClicked"
                            ToolTipService.ToolTip="View measurement history">
                    <Viewbox Height="{StaticResource FooterButtonViewboxHeight}" Stretch="Uniform">
                        <TextBlock Text="Messhistorie" TextAlignment="Center"/>
                    </Viewbox>
                </Button>

                <!-- Exportieren -->
                <Button Grid.Column="4" Background="#22b539" Foreground="White" FontWeight="Bold"
                            FontSize="{StaticResource FooterButtonFontSize}"
                            MinWidth="{StaticResource FooterButtonMinWidth}"
                            Height="{StaticResource FooterButtonHeight}"
                            Padding="0,6" BorderThickness="0"
                            Margin="{StaticResource FooterButtonMarginThickness}"
                            CornerRadius="{StaticResource FooterButtonCornerRadius}"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Click="OnUnimplementedClicked"
                            ToolTipService.ToolTip="Export measurement data">
                    <Viewbox Height="{StaticResource FooterButtonViewboxHeight}" Stretch="Uniform">
                        <TextBlock Text="Exportieren" TextAlignment="Center"/>
                    </Viewbox>
                </Button>
            </Grid>
        </Viewbox>
    </Grid>
</UserControl>