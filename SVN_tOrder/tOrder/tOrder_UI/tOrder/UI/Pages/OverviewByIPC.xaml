<!--
===========================================================================
📄 OverviewByIPC.xaml
===========================================================================

Page responsible for displaying machine cards by IPC grouping.
Uses WrapGrid layout inside ItemsControl for dynamic layout behavior.

ViewModel: OverviewByIPCVM
Bound to: ObservableCollection<CapacityPositionCardVM> → displayed via <MachineCard/>

Layout:
- Column 0: Left padding (52px)
- Column 1: Main content (WrapGrid)
- Column 2: Right padding (52px)
===========================================================================
-->

<Page
    x:Class="tOrder.UI.OverviewByIPC"
    x:Name="OverviewByIPCPage"

    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:tOrder.UI"
    xmlns:common="using:tOrder.Common"
    xmlns:controls="using:tOrder.UI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"

    mc:Ignorable="d"
    d:DesignWidth="1024"
    d:DesignHeight="768"
    d:DataContext="{d:DesignInstance Type=local:OverviewByIPCVM, IsDesignTimeCreatable=True}"

    x:DataType="local:OverviewByIPCVM"

    Width="Auto"
    Height="Auto"
    Background="{ThemeResource BackgroundColor}"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch"

    common:DesignProperties.Control="OverviewByIPCPage"
    common:DesignProperties.Position="Top"
    common:DesignProperties.GroupTag="Layout"
    common:DesignProperties.GroupSubTag="Page"
    common:DesignProperties.DesignWidth="1024"
    common:DesignProperties.DesignHeight="768">

    <!--===========================================================
        Resources: Layout binding proxy for scale and width config
    =============================================================-->
    <UserControl.Resources>
        <common:BindingProxy x:Key="LayoutConfigProxy"
                             x:Name="LayoutConfigProxy"
                             Data="{x:Bind LayoutConfig, Mode=OneWay}" />
    </UserControl.Resources>

    <Grid>
        <Viewbox x:Name="OverviewByIPCViewbox" Stretch="Uniform" Height="Auto">

            <Grid  x:Name="OverviewByIPCContainer" 
                     Width="{Binding Source={StaticResource LayoutConfigProxy}, Path=Data.DesignWidth}"
                    
                   Height="768" 
                  RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <ScaleTransform 
                        ScaleX="{StaticResource GlobalScaleFactor}"
                        ScaleY="{StaticResource GlobalScaleFactor}" />
                </Grid.RenderTransform>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="52" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="52" />
                </Grid.ColumnDefinitions>

                <ItemsControl Grid.Column="1"
                              ItemsSource="{x:Bind VM.CapacityCards, Mode=OneWay}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapGrid Orientation="Horizontal"
                                      HorizontalAlignment="Left"
                                      Margin="0,20,0,0" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="controls:CapacityPositionCardVM">
                            <controls:CapacityPositionCard />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </Viewbox>
    </Grid>
</Page>