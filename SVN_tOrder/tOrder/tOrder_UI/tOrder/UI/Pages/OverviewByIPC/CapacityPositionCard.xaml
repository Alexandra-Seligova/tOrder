<!--
‚ö†Ô∏è POZN√ÅMKA:
Pro spr√°vn√© p≈ôep√≠n√°n√≠ obsahu kartiƒçky (nap≈ô. mezi CardProductionContentC a CardMenuContentC)
je nutn√© pou≈æ√≠t klasick√Ω `{Binding}` m√≠sto modern√≠ho `{x:Bind}` na `Visibility`.
D≈Øvodem je, ≈æe `x:Bind` pou≈æ√≠v√° kompilovan√Ω binding bez podpory INotifyPropertyChanged pro booleany v konvertoru,
co≈æ zp≈Øsob√≠, ≈æe se UI neaktualizuje p≈ôi zmƒõnƒõ VMu.

P≈ô√≠klad:
    Spr√°vnƒõ: Visibility="{Binding IsContentVisible, Converter={StaticResource BoolToVisibilityConverter}}"
    Chybnƒõ : Visibility="{x:Bind VM.IsContentVisible, Converter={StaticResource BoolToVisibilityConverter}}"
-->


<UserControl
    x:Class="tOrder.UI.CapacityPositionCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:tOrder.UI"  
    xmlns:converters="using:tOrder.Common"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:VMs="using:tOrder.UI"
    x:DataType="VMs:CapacityPositionCardVM"

            Margin="8"
    Width="236"
    Height="340"
    >


    <UserControl.Resources>

        <!--=============================================================-->
        <!-- üß©[View Metadata] ‚Äì informace o komponentƒõ                  -->
        <!--=============================================================-->
        <!-- üìå √öƒçel komponenty a jej√≠ v√Ωchoz√≠ rozmƒõry -->
        <x:String x:Key="View_Description">
            CapacityPositionCard: Kompaktn√≠ karta zobrazuj√≠c√≠ stav stroje, pozici, oper√°tory a produkƒçn√≠ informace.
        </x:String>
        <x:Double x:Key="View_Width">236</x:Double>
        <x:Double x:Key="View_Height">340</x:Double>

        <!--=============================================================-->
        <!-- ‚öôÔ∏è[Layout Constants] ‚Äì rozvr≈æen√≠, pozice, mezery           -->
        <!--=============================================================-->
        <Thickness x:Key="Layout_MarginCardContent">4</Thickness>
        <Thickness x:Key="Layout_PaddingCardText">8,0,0,0</Thickness>
        <Thickness x:Key="Layout_RightValueMargin">0,0,20,0</Thickness>
        <Thickness x:Key="Layout_HeadingPadding">4,4,16,4</Thickness>
        <Thickness x:Key="Layout_StueckzaehlerMargin">10,0,8,3</Thickness>
        <Thickness x:Key="Layout_PersonFooterMargin">10,0,8,3</Thickness>

        <!--=============================================================-->
        <!-- ‚úíÔ∏è[Styles] ‚Äì typografie, zarovn√°n√≠, textov√© bloky         -->
        <!--=============================================================-->
        <!-- V√Ωchoz√≠ styl v≈°ech TextBlock≈Ø v r√°mci t√©to komponenty -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource CardTextColor}" />
        </Style>

        <!-- Specifick√© typografick√© styly -->
        <Style x:Key="TextLabelStyle" TargetType="TextBlock" BasedOn="{StaticResource T_SmallTextStyle}" />
        <Style x:Key="TextValueStyle" TargetType="TextBlock" BasedOn="{StaticResource T_MediumStrongTextStyle}" />
        <Style x:Key="TextStatusStyle" TargetType="TextBlock" BasedOn="{StaticResource T_NormalStrongTextStyle}" />
        <Style x:Key="TextCounterStyle" TargetType="TextBlock" BasedOn="{StaticResource T_SmallTextStyle}">
            <Setter Property="TextAlignment" Value="Right" />
            <Setter Property="Margin" Value="{StaticResource Layout_RightValueMargin}" />
            <Setter Property="Foreground" Value="White" />
        </Style>
        <Style x:Key="LeftAlignedTextBlock" TargetType="TextBlock" BasedOn="{StaticResource T_BaseTextBlockStyle}">
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="TextAlignment" Value="Left" />
            <Setter Property="Margin" Value="{StaticResource Layout_PaddingCardText}" />
        </Style>

        <!--=============================================================-->
        <!-- üåç[Localization Strings] ‚Äì p≈ôipraveno pro resw            -->
        <!--=============================================================-->
        <x:String x:Key="Label_OrderNumber">Prod.Auftrag:</x:String>
        <x:String x:Key="Label_Article">Artikel:</x:String>
        <x:String x:Key="Label_Charge">H√§ringcharge:</x:String>
        <x:String x:Key="Label_MaterialBatch">Materialcharge:</x:String>
        <x:String x:Key="Label_Counter">St√ºckZ√§hler:</x:String>

        <x:String x:Key="Label_Unknown">Unbekannt</x:String>
        <x:String x:Key="Label_Status_Running">L√§uft</x:String>
        <x:String x:Key="Label_Status_Free">Frei</x:String>
        <x:String x:Key="Label_Status_Stopped">Gestoppt</x:String>
        <x:String x:Key="Label_Status_Setup">Einstellung</x:String>

        <!--=============================================================-->
        <!-- üé®[Colors / Brushes] ‚Äì barevn√© sch√©ma komponenty           -->
        <!--=============================================================-->
        <Color x:Key="CardBackgroundColor">#FFFFFF</Color>
        <Color x:Key="CardHeadingBackgroundColor">#7FBE92</Color>
        <Color x:Key="CardHeadingNumberBackgroundColor">#00993D</Color>
        <Color x:Key="CardTextColor">#333333</Color>

        <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}" />
        <SolidColorBrush x:Key="CardTextBrush" Color="{StaticResource CardTextColor}" />

        <!--=============================================================-->
        <!-- üîÅ[Converters] ‚Äì p≈ôevodn√≠ky pro binding / styl             -->
        <!--=============================================================-->

        <converters:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:BooleanToVisibilityInverseConverter x:Key="BoolToCollapsedConverter" />

        <converters:StatusToBrushConverter x:Key="StatusToBrushConverter" />
        <converters:NumberFormattingConverter x:Key="NumberFormatConverter" />


    </UserControl.Resources>



    <Grid Background="{StaticResource CardBackgroundColor}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Head -->
        <local:CardHeadC
    Grid.Row="0"
    Height="68"
    CardHeadTextMain="{x:Bind VM.UnitCode, Mode=OneWay}"
    CardHeadTextSecondary="{x:Bind VM.UnitId, Mode=OneWay}"
    CardHeadNumber="{x:Bind VM.Index, Mode=OneWay}"
    CardHeadButton="{x:Bind VM.ToggleSectionsCommand}"
    CardHeadMainBrush="{x:Bind VM.UnitHeadBrush, Mode=OneWay}"
    CardHeadNumberBrush="{x:Bind VM.IndexBrush, Mode=OneWay}" />


        <!-- Dynamick√Ω obsah -->
        <local:CardContentSwitcherC
    DataContext="{x:Bind VM.ContentSwitcherVM}" 
            Grid.Row="1"
            
            
            
            />


        <!-- Footer -->
        <Grid Grid.Row="2" Background="{StaticResource PrimaryColor}">
            <Grid.RowDefinitions>
                <RowDefinition Height="22" />
                <RowDefinition Height="22" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Padding="{StaticResource Layout_PersonFooterMargin}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="20" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{x:Bind VM.VisiblePersonSafe.FullName, Mode=OneWay, FallbackValue='‚Äî'}"
                           Style="{StaticResource T_SmallTextStyle}" Foreground="White" VerticalAlignment="Center" />
                <TextBlock Grid.Column="1" Text="{x:Bind VM.VisiblePersonSafe.Id, Mode=OneWay, FallbackValue='‚Äî'}"
                           Style="{StaticResource T_SmallTextStyle}" Foreground="White" VerticalAlignment="Center" TextAlignment="Right" />
                <Button Grid.Column="2" Content="‚ãØ" Foreground="White" Visibility="{x:Bind VM.HasMoreUsers, Converter={StaticResource BoolToVisibilityConverter}}"
                        Style="{StaticResource TransparentIconButtonStyle}"
                        VerticalAlignment="Bottom" 
                        HorizontalAlignment="Right" 
                        Command="{x:Bind VM.ToggleOperatorPopupCommand}" Margin="0,6,0,0" />
            </Grid>
            <Grid Grid.Row="1" Padding="{StaticResource Layout_StueckzaehlerMargin}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="20" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{StaticResource Label_Counter}" Style="{StaticResource T_SmallTextStyle}"
                           Foreground="White" VerticalAlignment="Center" />
                <TextBlock Grid.Column="1" Text="{x:Bind VM.Counter, Converter={StaticResource NumberFormatConverter}, FallbackValue='‚Äî'}"
                           Style="{StaticResource T_SmallTextStyle}" Foreground="White" VerticalAlignment="Center" TextAlignment="Right" />
            </Grid>
            <local:PopupDisplayControl x:Name="OperatorPopup" DataContext="{x:Bind VM.OperatorPopupVM, Mode=OneWay}" />
        </Grid>

        <!-- Transparent Interaction Layer 
        <Rectangle Grid.RowSpan="3"
           Fill="Transparent"
           Tapped="{x:Bind VM.OnCardTapped}" />
-->

        <!-- Popup -->

    </Grid>
</UserControl>
